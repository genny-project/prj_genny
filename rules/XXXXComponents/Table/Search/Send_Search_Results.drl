package life.genny.rules;
import life.genny.rules.QRules;
import life.genny.qwanda.Answer;
import java.util.HashSet;

rule "Send Search Results"
    when
        rules : QRules( isState("GENERATED_TABLE_CONTENT")  &&
                        isState("SEND_SEARCH_RESULTS") &&
                        !isState("LOOP_TRIGGER_SEARCH_STEP_TWO") )
     then
      	rules.header();
		rules.setState("LOOP_TRIGGER_SEARCH_STEP_TWO");

        /* we get the bulk message */
        QBulkMessage bulkMsg = (QBulkMessage) rules.get("bulkMsg");
		rules.publishCmd(bulkMsg);

		rules.setState("SENT_SEARCH_RESULTS");
        rules.footer();
end

